#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
pass <- function(x) {
   x * pnorm(x) + dnorm(x)
}
passed <- function(x) {
   x * pnorm(x) + dnorm(x) - x
}
share <- function(x) {
   pass(x) / (pass(x) + passed(x))
}
ratio <- function(x) {
   pass(x) / passed(x)
}
ratio(1.3)
pnorm(1.3) / (1 - pnorm(1.3))
share(.5)
pnorm(.5)

ratio_sum <- function(x, density) {
   range <- 100
   percentile <- 0
   for (speed in seq(-range, x, 0.1)) {
      percentile <- percentile + density(speed) * 0.1
   }
   pass <- 0 # people you pass
   for (speed in seq(-range, x, 0.1)) {
      pass <- pass + density(speed) * (x - speed) * 0.1
   }
   passed <- 0 # people you're passed by
   for (speed in seq(x, range, 0.1)) {
      passed <- passed + density(speed) * (speed - x) * 0.1
   }
   # return (pass/passed) and (slower/faster)
   return(c(pass / passed, (percentile / (1 - percentile))))
}
ratio_sum(5, dnorm)
ratio_sum(5, function(x) {
   dt(x, df = 1)
})
ratio_sum(5, function(x) {
   dt(x, df = 2)
})

curve(dt(x, df = 1), -8, 8)
curve(x * dt(x, df = 2), from = -8, to = 8)
curve(x^0 - 1, -8, 8, add = TRUE)
# density= function(x){dt(x,df=1)}
# plot(density,xlim=c(-10,10))
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
